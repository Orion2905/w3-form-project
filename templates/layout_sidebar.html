{% extends 'layout_full.html' %}
{% block sidebar %}
<nav id="sidebar" class="sidebar border-end d-flex flex-column align-items-center">
  <div class="sidebar-logo my-3">
    <img src="https://placehold.co/48x48?text=W3" alt="Logo" width="48" height="48" style="border-radius:12px;">
  </div>
  <ul class="nav flex-column py-4 w-100 px-2">
    <li class="nav-item mb-2">
      <a class="nav-link d-flex align-items-center px-3 py-2 {% if request.endpoint == 'main.dashboard' or request.endpoint == 'main.index' %}active{% endif %}" href="/">
        <span class="sidebar-icon me-2"><i class="bi bi-house"></i></span>
        <span class="sidebar-text">Dashboard</span>
      </a>
    </li>
    <li class="nav-item mb-2">
      <a class="nav-link d-flex align-items-center px-3 py-2 {% if 'candidat' in request.endpoint %}active{% endif %}" href="/candidati">
        <span class="sidebar-icon me-2"><i class="bi bi-people"></i></span>
        <span class="sidebar-text">Elenco Candidati</span>
      </a>
    </li>
    <li class="nav-item mb-2">
      <a class="nav-link d-flex align-items-center px-3 py-2 {% if 'form' in request.endpoint %}active{% endif %}" href="/forms">
        <span class="sidebar-icon me-2"><i class="bi bi-ui-checks-grid"></i></span>
        <span class="sidebar-text">Gestione Form</span>
      </a>
    </li>
    <li class="nav-item mb-2">
      <a class="nav-link d-flex align-items-center px-3 py-2 {% if 'score' in request.endpoint or 'punteggi' in request.endpoint %}active{% endif %}" href="/punteggi/categorie">
        <span class="sidebar-icon me-2"><i class="bi bi-star"></i></span>
        <span class="sidebar-text">Punteggi</span>
      </a>
    </li>
    <li class="nav-item mt-4">
      <a class="nav-link d-flex align-items-center text-danger px-3 py-2" href="/logout">
        <span class="sidebar-icon me-2"><i class="bi bi-box-arrow-right"></i></span>
        <span class="sidebar-text">Logout</span>
      </a>
    </li>
  </ul>
</nav>
{% endblock %}
{% block main_content %}
<div class="flex-grow-1 p-4 d-flex flex-column">
  <!-- Breadcrumbs -->
  {% if breadcrumbs %}
  <nav aria-label="breadcrumb" class="mb-3">
    <ol class="breadcrumb">
      {% for breadcrumb in breadcrumbs %}
        {% if loop.last %}
          <li class="breadcrumb-item active" aria-current="page">{{ breadcrumb.name }}</li>
        {% else %}
          <li class="breadcrumb-item">
            {% if breadcrumb.url %}
              <a href="{{ breadcrumb.url }}">{{ breadcrumb.name }}</a>
            {% else %}
              {{ breadcrumb.name }}
            {% endif %}
          </li>
        {% endif %}
      {% endfor %}
    </ol>
  </nav>
  {% endif %}
  
  {% block content %}{% endblock %}
</div>
{% endblock %}
{% block scripts %}
<script>
// Sidebar toggle animazione, solo una dichiarazione globale
(function() {
  var sidebar = document.getElementById('sidebar');
  var sidebarToggle = document.getElementById('sidebarToggle');
  if(sidebar && sidebarToggle) {
    sidebarToggle.onclick = function() {
      sidebar.classList.toggle('sidebar-collapsed');
      // Aggiungi classe al body per gestire il layout
      document.body.classList.toggle('sidebar-collapsed', sidebar.classList.contains('sidebar-collapsed'));
      
      document.querySelectorAll('.sidebar-text').forEach(function(el) {
        el.style.display = sidebar.classList.contains('sidebar-collapsed') ? 'none' : 'inline';
      });
      sidebar.style.transition = 'width 0.3s cubic-bezier(.4,2,.6,1)';
    };
    // Inizializza stato testo sidebar
    document.querySelectorAll('.sidebar-text').forEach(function(el) {
      el.style.display = sidebar.classList.contains('sidebar-collapsed') ? 'none' : 'inline';
    });
    // Inizializza classe body se sidebar è già collassata
    document.body.classList.toggle('sidebar-collapsed', sidebar.classList.contains('sidebar-collapsed'));
  }
})();
</script>
{% endblock %}
